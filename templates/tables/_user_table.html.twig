<div class="table-responsive p-0">
  <table class="table align-items-center justify-content-center mb-0">
    <thead>
      <tr>
        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Utilisateur</th>
        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Email</th>
        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Téléphone</th>
        {% if role == 'Artisan' or role == 'Constructeur' %}
          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Spécialité</th>
          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Salaire / h</th>
        {% endif %}
        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Statut</th>
        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr data-bs-toggle="modal" data-bs-target="#viewUserModal{{ user.id }}" style="cursor: pointer;">
        <td>
          <div class="d-flex px-2">
            <div>
              <div class="avatar avatar-sm rounded-circle bg-gradient-dark me-2">
                <img src="../assets/img/default-avatar.png" class="avatar avatar-xs border-radius-lg" alt="user">
              </div>
            </div>
            <div class="my-auto">
              <h6 class="mb-0 text-sm">{{ user.nom }} {{ user.prenom }}</h6>
              <p class="text-xs text-secondary mb-0">
                {{ role }}
              </p>
            </div>
          </div>
        </td>
        <td class="text-center align-middle">
          <p class="text-sm font-weight-bold mb-0">{{ user.email }}</p>
        </td>
        <td class="text-center align-middle">
          <p class="text-sm font-weight-bold mb-0">{{ user.telephone }}</p>
        </td>
        {% if role == 'Artisan' %}
          {% set artisan = user.artisan ?? null %}
          <td class="text-center align-middle">
            <p class="text-sm font-weight-bold mb-0">{{ artisan is not null ? artisan.specialite : 'N/A' }}</p>
          </td>
          <td class="text-center align-middle">
            <p class="text-sm font-weight-bold mb-0">{{ artisan is not null ? artisan.salaireHeure ~ ' €' : 'N/A' }}</p>
          </td>
        {% elseif role == 'Constructeur' %}
          {% set constructeur = user.constructeur ?? null %}
          <td class="text-center align-middle">
            <p class="text-sm font-weight-bold mb-0">{{ constructeur is not null ? constructeur.specialite : 'N/A' }}</p>
          </td>
          <td class="text-center align-middle">
            <p class="text-sm font-weight-bold mb-0">{{ constructeur is not null ? constructeur.salaireHeure ~ ' €' : 'N/A' }}</p>
          </td>
        {% endif %}
        <td class="text-center align-middle">
          <span class="badge badge-sm bg-gradient-{{ user.statut == 'Actif' ? 'success' : 'secondary' }}">
            {{ user.statut }}
          </span>
        </td>
        <td class="text-center align-middle">
          <a href="{{ path('utilisateur_delete', { id: user.id }) }}"
             onclick="event.stopPropagation(); return confirm('Êtes-vous sûr de vouloir supprimer cet utilisateur ?');"
             class="text-danger font-weight-bold text-xs ms-2" 
             title="Supprimer">
            <i class="material-symbols-rounded">delete</i>
          </a>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="{{ role == 'Artisan' or role == 'Constructeur' ? 7 : 5 }}" class="text-center">Aucun utilisateur trouvé</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>